---
#
#  Part of https://github.com/jaclu/ish-fstools
#
#  Copyright (c) 2025-2026: Jacob.Lundqvist@gmail.com
#
#  License: MIT
#
#  main toolbook
#

# - name: Show all gathered facts
#   hosts: all
#   vars_files:
#     - vars.yml
#   gather_facts: true
#   tasks:
#     - name: Display all facts
#       debug:
#         var: ansible_facts

- name: Setting up iSH FS
  hosts: "{{ target_hosts | default('localhost') }}"
  vars:
    ansible_python_interpreter: /usr/bin/python3
  gather_facts: false

  pre_tasks:
    - name: Prepare env to run playbooks
      # vars:
      #   ift_quick_deploy: true
      #   # skip_cloning: true
      import_tasks: pre_tasks/main.yml
      tags: always

  roles:
    - role: alpine
      when: ansible_facts.os_family == 'Alpine'
    - role: debian
      when: ansible_facts.os_family == 'Debian'
    - role: all_distros

  post_tasks:
    - name: Run tasks/update_release.yml
      import_tasks: tasks/update_release.yml
